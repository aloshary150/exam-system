<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>دخول الامتحان</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>دخول الامتحان</header>
  <div class="container">
    <input id="studentName" placeholder="اسم الطالب" />
    <select id="examSelect"></select>
    <button onclick="startExam()">ابدأ الامتحان</button>
    <p id="msg" class="error"></p>
  </div>
  <script>
    const examSelect = document.getElementById("examSelect");
    const msg = document.getElementById("msg");
    async function loadExams() {
      const res = await fetch("/api/exam/list");
      const exams = await res.json();
      examSelect.innerHTML = '<option value="">-- اختر الامتحان --</option>';
      exams.forEach((e) => {
        const opt = document.createElement("option");
        opt.value = e.id;
        opt.textContent = `${e.subject} - الصف ${e.grade} - مدة: ${e.duration} دقيقة`;
        examSelect.appendChild(opt);
      });
    }
    async function startExam() {
      msg.textContent = "";
      const studentName = document.getElementById("studentName").value.trim();
      const examId = examSelect.value;
      if (!studentName || !examId) {
        msg.textContent = "يرجى تعبئة الاسم واختيار الامتحان";
        return;
      }
      localStorage.setItem("studentName", studentName);
      localStorage.setItem("examId", examId);
      location.href = `exam.html?examId=${examId}`;
    }
    loadExams();
  </script>
</body>
</html>
